<div style="padding: 20px; font-family: system-ui, -apple-system, sans-serif;">
  <h1>Book Recommendation Admin Dashboard</h1>
  <p style="color: #666; margin-bottom: 30px;">Welcome to the book recommendation system admin panel</p>

  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <%= link_to admin_books_path, style: "text-decoration: none; color: inherit;" do %>
      <div style="background: #e3f2fd; padding: 30px; border-radius: 8px; text-align: center; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
        <h2 style="margin: 0 0 10px 0; font-size: 3em;"><%= @total_books %></h2>
        <p style="margin: 0; color: #1976d2; font-weight: bold;">Total Books</p>
      </div>
    <% end %>
    
    <div style="background: #e8f5e9; padding: 30px; border-radius: 8px; text-align: center;">
      <h2 style="margin: 0 0 10px 0; font-size: 3em;"><%= @total_reviews %></h2>
      <p style="margin: 0; color: #2e7d32; font-weight: bold;">Total Reviews</p>
    </div>
    
    <%= link_to admin_book_queries_path, style: "text-decoration: none; color: inherit;" do %>
      <div style="background: #fff3e0; padding: 30px; border-radius: 8px; text-align: center; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
        <h2 style="margin: 0 0 10px 0; font-size: 3em;"><%= @total_queries %></h2>
        <p style="margin: 0; color: #e65100; font-weight: bold;">Total Queries</p>
      </div>
    <% end %>
    
    <div style="background: #f3e5f5; padding: 30px; border-radius: 8px; text-align: center;">
      <h2 style="margin: 0 0 10px 0; font-size: 3em;"><%= Book.average(:rating)&.round(2) || 0 %></h2>
      <p style="margin: 0; color: #6a1b9a; font-weight: bold;">Average Rating</p>
    </div>
  </div>

  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
    <div>
      <div style="background: white; padding: 20px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px;">
        <h3>üî• Trending Books</h3>
        <% if @trending_books.any? %>
          <% @trending_books.each do |book| %>
            <div style="padding: 10px 0; border-bottom: 1px solid #eee;">
              <%= link_to book.title, admin_book_path(book), style: "color: #333; text-decoration: none; font-weight: 500;" %>
              <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                <span style="color: #666; font-size: 0.9em;"><%= book.author %></span>
                <span style="color: #f44336; font-weight: bold;">Score: <%= book.trending_score %></span>
              </div>
            </div>
          <% end %>
        <% else %>
          <p style="color: #999;">No trending books at the moment.</p>
        <% end %>
      </div>

      <div style="background: white; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
        <h3>‚≠ê Top Rated Books</h3>
        <% if @top_rated_books.any? %>
          <% @top_rated_books.each do |book| %>
            <div style="padding: 10px 0; border-bottom: 1px solid #eee;">
              <%= link_to book.title, admin_book_path(book), style: "color: #333; text-decoration: none; font-weight: 500;" %>
              <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                <span style="color: #666; font-size: 0.9em;"><%= book.author %></span>
                <span style="color: #4caf50; font-weight: bold;"><%= book.rating.round(2) %> ‚òÖ</span>
              </div>
            </div>
          <% end %>
        <% else %>
          <p style="color: #999;">No rated books yet.</p>
        <% end %>
      </div>
    </div>

    <div>
      <div style="background: white; padding: 20px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px;">
        <h3>üìù Recent Queries</h3>
        <% if @recent_queries.any? %>
          <% @recent_queries.each do |query| %>
            <div style="padding: 10px 0; border-bottom: 1px solid #eee;">
              <div style="display: flex; justify-content: space-between; align-items: start;">
                <div style="flex: 1; margin-right: 10px;">
                  <%= link_to truncate(query.query_text, length: 50), admin_book_query_path(query), style: "color: #333; text-decoration: none;" %>
                </div>
                <% if query.success %>
                  <span style="background: #4caf50; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8em;">Success</span>
                <% else %>
                  <span style="background: #f44336; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8em;">Failed</span>
                <% end %>
              </div>
              <small style="color: #999;"><%= query.created_at.strftime("%b %d, %H:%M") %></small>
            </div>
          <% end %>
        <% else %>
          <p style="color: #999;">No queries logged yet.</p>
        <% end %>
      </div>

      <div style="background: white; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
        <h3>üí¨ Recent Reviews</h3>
        <% if @recent_reviews.any? %>
          <% @recent_reviews.each do |review| %>
            <div style="padding: 10px 0; border-bottom: 1px solid #eee;">
              <div style="font-weight: 500;"><%= review.book.title %></div>
              <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                <span style="color: #666; font-size: 0.9em;"><%= review.reviewer_name || "Anonymous" %></span>
                <span style="color: <%= review.rating >= 4 ? '#4caf50' : '#ff9800' %>;">
                  <%= "‚òÖ" * review.rating %>
                </span>
              </div>
              <small style="color: #999;"><%= review.created_at.strftime("%b %d, %H:%M") %></small>
            </div>
          <% end %>
        <% else %>
          <p style="color: #999;">No reviews yet.</p>
        <% end %>
      </div>
    </div>
  </div>

  <div style="margin-top: 30px; padding: 20px; background: #f5f5f5; border-radius: 8px;">
    <h3>Quick Actions</h3>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
      <%= link_to "Manage Books", admin_books_path, style: "background: #2196f3; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;" %>
      <%= link_to "View Query Logs", admin_book_queries_path, style: "background: #ff9800; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;" %>
      <%= link_to "Generate Sample Data", "#", onclick: "if(confirm('This will run the book_data:generate rake task. Continue?')) { alert('Please run: rails book_data:generate'); } return false;", style: "background: #4caf50; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;" %>
      <%= link_to "Update Trending", "#", onclick: "if(confirm('This will run the book_data:update_trending rake task. Continue?')) { alert('Please run: rails book_data:update_trending'); } return false;", style: "background: #9c27b0; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;" %>
    </div>
  </div>
</div>
