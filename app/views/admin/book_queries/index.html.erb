<div style="padding: 20px; font-family: system-ui, -apple-system, sans-serif;">
  <%= link_to "â† Back to Books", admin_books_path, style: "color: #1976d2; text-decoration: none; margin-bottom: 20px; display: inline-block;" %>
  
  <h1>Book Query Logs</h1>
  <p style="color: #666; margin-bottom: 30px;">View all queries made to the book recommendation assistant</p>

  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div style="background: #e8f5e9; padding: 20px; border-radius: 8px; text-align: center;">
      <h3 style="margin: 0 0 10px 0;">Successful</h3>
      <div style="font-size: 2em; font-weight: bold; color: #2e7d32;"><%= @successful_queries %></div>
    </div>
    
    <div style="background: #ffebee; padding: 20px; border-radius: 8px; text-align: center;">
      <h3 style="margin: 0 0 10px 0;">Failed</h3>
      <div style="font-size: 2em; font-weight: bold; color: #c62828;"><%= @failed_queries %></div>
    </div>
    
    <div style="background: #e3f2fd; padding: 20px; border-radius: 8px; text-align: center;">
      <h3 style="margin: 0 0 10px 0;">Avg Response Time</h3>
      <div style="font-size: 2em; font-weight: bold; color: #1565c0;"><%= @avg_response_time %>ms</div>
    </div>
    
    <div style="background: #f3e5f5; padding: 20px; border-radius: 8px; text-align: center;">
      <h3 style="margin: 0 0 10px 0;">Total Queries</h3>
      <div style="font-size: 2em; font-weight: bold; color: #6a1b9a;"><%= @book_queries.count %></div>
    </div>
  </div>

  <% if @book_queries.any? %>
    <table style="width: 100%; border-collapse: collapse; background: white;">
      <thead>
        <tr style="background: #f5f5f5;">
          <th style="padding: 15px; text-align: left; border-bottom: 2px solid #ddd;">Query Text</th>
          <th style="padding: 15px; text-align: center; border-bottom: 2px solid #ddd;">Status</th>
          <th style="padding: 15px; text-align: center; border-bottom: 2px solid #ddd;">Response Time</th>
          <th style="padding: 15px; text-align: center; border-bottom: 2px solid #ddd;">Date</th>
          <th style="padding: 15px; text-align: center; border-bottom: 2px solid #ddd;">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @book_queries.each do |query| %>
          <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 15px; max-width: 400px;">
              <div style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                <%= query.query_text %>
              </div>
            </td>
            <td style="padding: 15px; text-align: center;">
              <% if query.success %>
                <span style="background: #4caf50; color: white; padding: 4px 12px; border-radius: 4px;">Success</span>
              <% else %>
                <span style="background: #f44336; color: white; padding: 4px 12px; border-radius: 4px;">Failed</span>
              <% end %>
            </td>
            <td style="padding: 15px; text-align: center;">
              <%= query.response_time_ms ? "#{query.response_time_ms}ms" : "N/A" %>
            </td>
            <td style="padding: 15px; text-align: center;">
              <%= query.created_at.strftime("%Y-%m-%d %H:%M") %>
            </td>
            <td style="padding: 15px; text-align: center;">
              <%= link_to "View Details", admin_book_query_path(query), style: "color: #1976d2;" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div style="padding: 40px; text-align: center; background: #f5f5f5; border-radius: 8px;">
      <p style="color: #999; font-size: 1.2em;">No queries have been logged yet.</p>
      <p style="color: #666;">Queries will appear here once the book assistant is used.</p>
    </div>
  <% end %>
</div>
